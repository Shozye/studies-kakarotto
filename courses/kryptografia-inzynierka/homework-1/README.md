# Zadanie Domowe 1.

1. Zaimplementuj w dowolnym języku programowania funkcję RSA w wersji podstawowej (parametry `x, n, e`) i z wykorzystaniem Chińskiego Twierdzenia o Resztach (CRT, parametry `x, p, q, dp, dq, qi`).

2. Wykorzystaj funkcje z polecenia 1. do zaimplementowania dwóch mini-programów:

   * pierwszy przyjmuje z linii poleceń `x`, `n` i `e` w postaci dziesiętnej i wylicza podstawową funkcję RSA z polecenia 1., a następnie wypisuje wynik w postaci dziesiętnej;
   * drugi działa analogicznie dla funkcji wykorzystującej CRT.

3. (\*) Zapoznaj się ze specyfikacją JWK w [RFC 7517](https://datatracker.ietf.org/doc/html/rfc7517) i reprezentacją kluczy RSA w [RFC 7518](https://datatracker.ietf.org/doc/html/rfc7518#section-6.3).
   Przerób programy z polecenia 2. tak, aby zamiast przyjmować parametry klucza z linii poleceń, przyjmowały je z pliku zawierającego pojedynczy JWK. Przyjmij, że pierwszy program zawsze
   dostaje JWK w postaci "RSA Public Key" (sec. 6.3.1. w [RFC 7518](https://datatracker.ietf.org/doc/html/rfc7518#section-6.3.1)),
   a drugi zawsze w pełnej "RSA Private Key" (sec. 6.3.2. w [RFC 7518](https://datatracker.ietf.org/doc/html/rfc7518#section-6.3.2)).

Uwaga: programy muszą obsługiwać arytmetykę typową dla RSA, tj. powyżej 2048 bitów na liczbę (i działać w rozsądnym czasie). Dlatego istotne jest dobranie odpowiednich narzędzi, np.
w języku Python zwykły typ całkowitoliczbowy (`int`) potrafi obsłużyć dowolną precyzję, w języku Julia idealnie nadaje się do tego typ `BigInt`, a np. w Javie - `BigInteger`.
W języku C można użyć np. typu `BIGNUM` z biblioteki [OpenSSL](https://www.openssl.org/docs/man1.0.2/man3/bn.html) lub `mpz_t` z [GNU MP](https://gmplib.org/manual/index).

Przykłady użycia:

```
$ zadanie-2a 123456 183457 17
165799
$ zadanie-2a 165799 183457 10741
123456

$ zadanie-2b 165799 383 479 45 225 4
123456
$ zadanie-2b 123456 383 479 45 225 4
124040
$ zadanie-2a 124040 183457 17
123456

$ zadanie-2a 123456 26634547600177008912365441464036882611104634136430581696102639463075266436216946316053845642300166320042915031924501272705275043130211783228252369194856949397782880847235143381529207382262647906987655738647387007320361149854766523417293323739185308113373529512728932838100141612048712597178695720651344295450174895369923383396704334331627261565907266749863744707920606364678231639106403854977302183719246256958550651555767664134467706614553219592981545363271425781391262006405169505726523023628770285432062044391310047445749287563161668548354322560223509946990827691654627968182167826397015368836435965354956581554819 65537
9996461122498386712870555303564649657851858757895612968316098781413903517823362079256925567068383018846244636605693119587559524547088338151024889593028297604145507373563096304925300096186608144748894070384550891237622292130016093020276322457751274726522583269664907778180797715831303400572558911431129493279344922592244221708490723165830762068983163321215045538625852433643073482361438052099365960550793633490221762288462650035891250326071521405916818471127799270925696910399626523585388441962730025048784817211566741537706130179374727186311244362876927015885132639750572800364270723954549075834179192223831977315665

$ cat rsa_pub.jwk
{
  "kty": "RSA",
  "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMstn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbISD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
  "e": "AQAB",
  "alg": "RS256",
  "kid": "2011-04-29"
}


$ zadanie-3a 123456 rsa_pub.jwk
9996461122498386712870555303564649657851858757895612968316098781413903517823362079256925567068383018846244636605693119587559524547088338151024889593028297604145507373563096304925300096186608144748894070384550891237622292130016093020276322457751274726522583269664907778180797715831303400572558911431129493279344922592244221708490723165830762068983163321215045538625852433643073482361438052099365960550793633490221762288462650035891250326071521405916818471127799270925696910399626523585388441962730025048784817211566741537706130179374727186311244362876927015885132639750572800364270723954549075834179192223831977315665

$ cat rsa_priv.jwk
{
  "kty": "RSA",
  "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMstn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbISD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqbw0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
  "e": "AQAB",
  "d": "X4cTteJY_gn4FYPsXB8rdXix5vwsg1FLN5E3EaG6RJoVH-HLLKD9M7dx5oo7GURknchnrRweUkC7hT5fJLM0WbFAKNLWY2vv7B6NqXSzUvxT0_YSfqijwp3RTzlBaCxWp4doFk5N2o8Gy_nHNKroADIkJ46pRUohsXywbReAdYaMwFs9tv8d_cPVY3i07a3t8MN6TNwm0dSawm9v47UiCl3Sk5ZiG7xojPLu4sbg1U2jx4IBTNBznbJSzFHK66jT8bgkuqsk0GjskDJk19Z4qwjwbsnn4j2WBii3RL-Us2lGVkY8fkFzme1z0HbIkfz0Y6mqnOYtqc0X4jfcKoAC8Q",
  "p": "83i-7IvMGXoMXCskv73TKr8637FiO7Z27zv8oj6pbWUQyLPQBQxtPVnwD20R-60eTDmD2ujnMt5PoqMrm8RfmNhVWDtjjMmCMjOpSXicFHj7XOuVIYQyqVWlWEh6dN36GVZYk93N8Bc9vY41xy8B9RzzOGVQzXvNEvn7O0nVbfs",
  "q": "3dfOR9cuYq-0S-mkFLzgItgMEfFzB2q3hWehMuG0oCuqnb3vobLyumqjVZQO1dIrdwgTnCdpYzBcOfW5r370AFXjiWft_NGEiovonizhKpo9VVS78TzFgxkIdrecRezsZ-1kYd_s1qDbxtkDEgfAITAG9LUnADun4vIcb6yelxk",
  "dp": "G4sPXkc6Ya9y8oJW9_ILj4xuppu0lzi_H7VTkS8xj5SdX3coE0oimYwxIi2emTAue0UOa5dpgFGyBJ4c8tQ2VF402XRugKDTP8akYhFo5tAA77Qe_NmtuYZc3C3m3I24G2GvR5sSDxUyAN2zq8Lfn9EUms6rY3Ob8YeiKkTiBj0",
  "dq": "s9lAH9fggBsoFR8Oac2R_E2gw282rT2kGOAhvIllETE1efrA6huUUvMfBcMpn8lqeW6vzznYY5SSQF7pMdC_agI3nG8Ibp1BUb0JUiraRNqUfLhcQb_d9GF4Dh7e74WbRsobRonujTYN1xCaP6TO61jvWrX-L18txXw494Q_cgk",
  "qi": "GyM_p6JrXySiz1toFgKbWV-JdI3jQ4ypu9rbMWx3rQJBfmt0FoYzgUIZEVFEcOqwemRN81zoDAaa-Bk0KWNGDjJHZDdDmFhW3AN7lI-puxk_mHZGJ11rxyR8O55XLSe3SPmRfKwZI6yU24ZxvQKFYItdldUKGzO6Ia6zTKhAVRU",
  "alg": "RS256",
  "kid": "2011-04-29"
}

$ zadanie-3b 9996461122498386712870555303564649657851858757895612968316098781413903517823362079256925567068383018846244636605693119587559524547088338151024889593028297604145507373563096304925300096186608144748894070384550891237622292130016093020276322457751274726522583269664907778180797715831303400572558911431129493279344922592244221708490723165830762068983163321215045538625852433643073482361438052099365960550793633490221762288462650035891250326071521405916818471127799270925696910399626523585388441962730025048784817211566741537706130179374727186311244362876927015885132639750572800364270723954549075834179192223831977315665 rsa_priv.jwk
123456
```
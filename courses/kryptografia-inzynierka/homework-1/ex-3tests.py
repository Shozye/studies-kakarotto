import subprocess


def test_ex3a(real_x, real_y):
    y = subprocess.run(["python3", "ex-3a.py", real_x, "rsa_pub.jwk"], stdout=subprocess.PIPE, text=True)
    assert y.stdout.strip() == real_y


def test_ex3b(real_y, real_x):
    x = subprocess.run(["python3", "ex-3b.py", real_y, "rsa_priv.jwk"], stdout=subprocess.PIPE, text=True)
    assert x.stdout.strip() == real_x


if __name__ == "__main__":
    X = "123456"
    Y = "9996461122498386712870555303564649657851858757895612968316098781413903517823362079256925567068383018846244636605693119587559524547088338151024889593028297604145507373563096304925300096186608144748894070384550891237622292130016093020276322457751274726522583269664907778180797715831303400572558911431129493279344922592244221708490723165830762068983163321215045538625852433643073482361438052099365960550793633490221762288462650035891250326071521405916818471127799270925696910399626523585388441962730025048784817211566741537706130179374727186311244362876927015885132639750572800364270723954549075834179192223831977315665"
    test_ex3a(X, Y)
    test_ex3b(Y, X)
